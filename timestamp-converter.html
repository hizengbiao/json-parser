<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êó∂Èó¥Êà≥ËΩ¨Êç¢Â∑•ÂÖ∑</title>
    <style>
        :root {
            --bg-color: #f4f6f8;
            --panel-bg: #ffffff;
            --border-color: #d1d5db;
            --text-color: #333;
            --accent-color: #0969da;
            --accent-hover: #0a58ca;
            --danger-color: #cf222e;
            --danger-hover: #a40e26;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            width: 100%;
        }

        .back-link {
            display: block;
            margin-bottom: 20px;
            color: var(--accent-color);
            text-decoration: none;
            font-size: 14px;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        /* Nav Bar */
        .nav-header {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #d0d7de;
            align-items: center;
            flex-wrap: wrap;
            width: 100%;
            justify-content: center;
        }

        .nav-item {
            text-decoration: none;
            color: #57606a;
            font-size: 14px;
            font-weight: 600;
            padding: 5px 10px;
            border-radius: 6px;
            transition: 0.2s;
        }

        .nav-item:hover {
            background-color: #f3f4f6;
            color: #24292f;
        }

        .nav-item.active {
            background-color: #0969da;
            color: white;
        }

        h1 {
            font-size: 24px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .card {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
        }

        .card h2 {
            font-size: 16px;
            margin: 0 0 15px 0;
            color: #57606a;
            font-weight: 600;
        }

        /* Current Timestamp Section */
        .current-time-display {
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 48px;
            font-weight: 500;
            margin-bottom: 15px;
            color: #1f2328;
            display: flex;
            align-items: baseline;
            gap: 10px;
        }

        .unit-label {
            font-size: 14px;
            color: #6e7781;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
        }

        .controls {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 6px 14px;
            font-size: 14px;
            border-radius: 6px;
            border: 1px solid rgba(27, 31, 35, 0.15);
            cursor: pointer;
            background-color: #fff;
            color: #24292f;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: 0.2s;
            text-decoration: none;
        }

        .btn:hover {
            background-color: #f3f4f6;
        }

        .btn-primary {
            background-color: #24292f;
            color: white;
            border: none;
        }

        .btn-primary:hover {
            background-color: #4b525a;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
            border: none;
        }

        .btn-danger:hover {
            background-color: var(--danger-hover);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
            background: #f6f8fa;
            border-radius: 6px 6px 0 0;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            text-align: center;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 500;
            color: #57606a;
            border-bottom: 2px solid transparent;
        }

        .tab-btn.active {
            color: #0969da;
            border-bottom-color: #0969da;
            background: white;
            border-radius: 6px 6px 0 0;
        }

        /* Conversion Rows */
        .io-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .io-group label {
            width: 100%;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #24292f;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .input-wrapper {
            flex: 1;
            min-width: 200px;
        }

        input[type="text"],
        select {
            width: 100%;
            padding: 8px 12px;
            font-size: 14px;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            outline: none;
            box-sizing: border-box;
            background: #fff;
        }

        input[type="text"]:focus,
        select:focus {
            border-color: #0969da;
            box-shadow: 0 0 0 2px rgba(9, 105, 218, 0.3);
        }

        .select-wrapper {
            width: 140px;
        }

        .action-btn {
            background-color: #24292f;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
        }

        .action-btn:hover {
            background-color: #4b525a;
        }

        /* Toast */
        #toast {
            visibility: hidden;
            min-width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 4px;
            padding: 10px;
            position: fixed;
            z-index: 1000;
            left: 50%;
            bottom: 30px;
            transform: translateX(-50%);
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s, bottom 0.3s;
        }

        #toast.show {
            visibility: visible;
            opacity: 1;
            bottom: 50px;
        }

        @media (max-width: 600px) {
            .current-time-display {
                font-size: 32px;
            }

            .io-group {
                flex-direction: column;
                align-items: stretch;
            }

            .select-wrapper,
            .action-btn {
                width: 100%;
            }
        }
    </style>
</head>

<body>

    <div class="nav-header">
        <a href="index.html" class="nav-item">üè† È¶ñÈ°µ</a>
        <a href="json-parser.html" class="nav-item">JSON Â∑•ÂÖ∑</a>
        <a href="timestamp-converter.html" class="nav-item active">Êó∂Èó¥Êà≥</a>
        <a href="url-encoder.html" class="nav-item">URL ÁºñËß£Á†Å</a>
        <a href="base64-encoder.html" class="nav-item">Base64</a>
    </div>

    <div class="container">
        <h1>Êó∂Èó¥Êà≥ËΩ¨Êç¢</h1>

        <!-- Live Clock Card -->
        <div class="card">
            <h2>ÂΩìÂâçÊó∂Èó¥Êà≥</h2>
            <div class="current-time-display">
                <span id="live-timestamp">0</span>
                <span class="unit-label" id="live-unit-label">Áßí</span>
            </div>
            <div class="controls">
                <button class="btn" onclick="toggleLiveUnit()">üîÑ ÂàáÊç¢Âçï‰Ωç</button>
                <button class="btn" onclick="copyLiveTimestamp()">üìã Â§çÂà∂</button>
                <button class="btn btn-danger" id="stop-btn" onclick="toggleTimer()">‚ñ° ÂÅúÊ≠¢</button>
            </div>
        </div>

        <!-- Conversion Card -->
        <div class="card" style="padding: 0; border: none; background: none; box-shadow: none;">
            <div class="tabs">
                <button class="tab-btn active">Âçï‰∏™ËΩ¨Êç¢</button>
                <button class="tab-btn" style="cursor: not-allowed; opacity: 0.6;">ÊâπÈáèËΩ¨Êç¢ (Coming Soon)</button>
            </div>

            <div
                style="background: white; border: 1px solid var(--border-color); border-top: none; padding: 25px; border-radius: 0 0 8px 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.04);">

                <!-- Timestamp to Date -->
                <div class="io-group">
                    <label>üïì Êó∂Èó¥Êà≥ËΩ¨Êó•ÊúüÊó∂Èó¥</label>
                    <div class="input-wrapper">
                        <input type="text" id="ts-input" placeholder="ËæìÂÖ•Êó∂Èó¥Êà≥">
                    </div>
                    <div class="select-wrapper" style="width: 100px;">
                        <select id="ts-unit">
                            <option value="s">Áßí(s)</option>
                            <option value="ms">ÊØ´Áßí(ms)</option>
                        </select>
                    </div>
                    <button class="action-btn" onclick="convertTsToDate()">ËΩ¨Êç¢</button>
                    <div class="input-wrapper" style="flex: 2;">
                        <input type="text" id="date-output" placeholder="ËΩ¨Êç¢ÁªìÊûú" readonly
                            style="background-color: #f6f8fa;">
                    </div>
                    <div class="select-wrapper">
                        <select id="timezone-select-1">
                            <!-- Populated by JS -->
                        </select>
                    </div>
                </div>

                <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">

                <!-- Date to Timestamp -->
                <div class="io-group">
                    <label>üìÖ Êó•ÊúüÊó∂Èó¥ËΩ¨Êó∂Èó¥Êà≥</label>
                    <div class="input-wrapper" style="flex: 2;">
                        <input type="text" id="date-input" placeholder="YYYY-MM-DD HH:mm:ss">
                    </div>
                    <div class="select-wrapper">
                        <select id="timezone-select-2">
                            <!-- Populated by JS -->
                        </select>
                    </div>
                    <button class="action-btn" onclick="convertDateToTs()">ËΩ¨Êç¢</button>
                    <div class="input-wrapper">
                        <input type="text" id="ts-output" placeholder="ËΩ¨Êç¢ÁªìÊûú" readonly
                            style="background-color: #f6f8fa;">
                    </div>
                    <div class="select-wrapper" style="width: 100px;">
                        <select id="date-unit">
                            <option value="s">Áßí(s)</option>
                            <option value="ms">ÊØ´Áßí(ms)</option>
                        </select>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="toast">ÊèêÁ§∫‰ø°ÊÅØ</div>

    <script>
        // --- Configuration ---
        const timezones = [
            { label: 'Asia/Shanghai (CST)', value: 'Asia/Shanghai' },
            { label: 'UTC', value: 'UTC' },
            { label: 'America/New_York (EST)', value: 'America/New_York' },
            { label: 'Europe/London (GMT)', value: 'Europe/London' },
            { label: 'Asia/Tokyo (JST)', value: 'Asia/Tokyo' }
        ];

        // --- State ---
        let timerId = null;
        let isLiveRunning = true;
        let isLiveSeconds = true;

        // --- DOM Elements ---
        const elLiveTs = document.getElementById('live-timestamp');
        const elLiveUnit = document.getElementById('live-unit-label');
        const elStopBtn = document.getElementById('stop-btn');

        const elTsInput = document.getElementById('ts-input');
        const elTsUnit = document.getElementById('ts-unit');
        const elDateOutput = document.getElementById('date-output');
        const elTz1 = document.getElementById('timezone-select-1');

        const elDateInput = document.getElementById('date-input');
        const elTz2 = document.getElementById('timezone-select-2');
        const elTsOutput = document.getElementById('ts-output');
        const elDateUnit = document.getElementById('date-unit');

        // --- Init ---
        function init() {
            // Populate Timezones
            const localTz = Intl.DateTimeFormat().resolvedOptions().timeZone;

            [elTz1, elTz2].forEach(select => {
                timezones.forEach(tz => {
                    const opt = document.createElement('option');
                    opt.value = tz.value;
                    opt.textContent = tz.label;
                    if (tz.value === 'Asia/Shanghai') opt.selected = true; // Default to Shanghai as per screenshot
                    select.appendChild(opt);
                });
                // Add local if not exists? simplified for now.
            });

            // Start Clock
            updateClock();
            timerId = setInterval(updateClock, 1000);

            // Init Inputs
            const now = new Date();
            elTsInput.value = Math.floor(now.getTime() / 1000);
            elDateInput.value = formatDate(now, 'Asia/Shanghai');
        }

        // --- Live Clock ---
        function updateClock() {
            const now = new Date().getTime();
            if (isLiveSeconds) {
                elLiveTs.textContent = Math.floor(now / 1000);
            } else {
                elLiveTs.textContent = now;
            }
        }

        function toggleTimer() {
            if (isLiveRunning) {
                clearInterval(timerId);
                elStopBtn.textContent = '‚ñ∂ ÂºÄÂßã';
                elStopBtn.classList.replace('btn-danger', 'btn-primary');
                elStopBtn.style.backgroundColor = '#1f883d'; // Greenish
            } else {
                updateClock();
                timerId = setInterval(updateClock, isLiveSeconds ? 1000 : 50); // Faster update for ms
                elStopBtn.textContent = '‚ñ° ÂÅúÊ≠¢';
                elStopBtn.classList.replace('btn-primary', 'btn-danger');
                elStopBtn.style.backgroundColor = ''; // Revert to class style
            }
            isLiveRunning = !isLiveRunning;
        }

        function toggleLiveUnit() {
            isLiveSeconds = !isLiveSeconds;
            elLiveUnit.textContent = isLiveSeconds ? 'Áßí' : 'ÊØ´Áßí';

            // Restart timer to adjust interval
            if (isLiveRunning) {
                clearInterval(timerId);
                timerId = setInterval(updateClock, isLiveSeconds ? 1000 : 50);
                updateClock();
            } else {
                // Just update display immediately if paused
                updateClock();
            }
        }

        function copyLiveTimestamp() {
            copyText(elLiveTs.textContent);
        }

        // --- Logic: Timestamp -> Date ---
        function convertTsToDate() {
            let val = elTsInput.value.trim();
            if (!val) return;

            // Simple validation
            if (!/^\d+$/.test(val)) {
                showToast("ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊï∞Â≠óÊó∂Èó¥Êà≥");
                return;
            }

            let ts = parseInt(val, 10);
            const unit = elTsUnit.value;

            // Convert to ms for Date object
            if (unit === 's') {
                ts *= 1000;
            }

            const date = new Date(ts);
            if (isNaN(date.getTime())) {
                showToast("Êó†ÊïàÁöÑÊó∂Èó¥Êà≥");
                return;
            }

            const tz = elTz1.value;
            elDateOutput.value = formatDate(date, tz);
        }

        // --- Logic: Date -> Timestamp ---
        function convertDateToTs() {
            let val = elDateInput.value.trim();
            if (!val) return;

            // Try to parse. User might input YYYY-MM-DD HH:mm:ss
            // We need to interpret this string AS the selected timezone.
            // JS Date.parse assumes local or UTC if ISO.

            // Strategy: Create a date object that represents the same content in UTC, then shift it.
            // Or use libraries. Since vanilla, we'll try a trick or just use formatting comparisons.
            // Best vanilla way: parse as string, create date, then adjust for timezone offset.

            // However, `new Date("2023-01-01 12:00:00")` is typically treated as local time in string parsing.
            // Let's rely on constructing a date object and then using standard methods.

            const tz = elTz2.value;

            // 1. naive parse (browser local)
            let date = new Date(val);
            if (isNaN(date.getTime())) {
                showToast("Êó†ÊïàÁöÑÊó•ÊúüÊ†ºÂºèÔºåËØ∑‰ΩøÁî® YYYY-MM-DD HH:mm:ss");
                return;
            }

            // The user INTENDED 'val' to be in 'tz'.
            // But 'date' interprets 'val' as Local (usually).
            // We need to find the specific UTC timestamp that, when displayed in 'tz', matches 'val'.

            // Complex without Moment.js/Day.js. 
            // Simplified approach for typical inputs:
            // 1. Parse string manually to get components.
            // 2. Create version in UTC.
            // 3. Subtract offset?

            // Let's try to assume input is standard format 
            // We can treat the input string as ISO by replacing space with T
            // "2023-01-01 12:00:00" -> "2023-01-01T12:00:00" -> Local time logic applies.

            // Hacky reliable way for no-dep:
            // Utilize toLocaleString to binary search or offset search? Too slow.
            // Let's stick strictly to what the browser gives or just warn user.

            // Actually, we can use `new Date(Date.UTC(...))` if we parse the numbers manually.
            // 2024-12-30 00:33:58
            const match = val.match(/^(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2}):(\d{2})$/);
            if (match) {
                const [_, y, m, d, h, min, s] = match;
                // Construct UTC date with these components
                // basically stating: "This time exists in UTC... wait no"

                // We want: Time in TZ = y,m,d...
                // Only reliable lightweight way is if we only support UTC and Local. 
                // Supporting arbitrary TZ like 'Asia/Shanghai' without a library is painful in vanilla JS because we can't easily "Set" time in a timezone.

                // Workaround: 
                // We will accept the input, create a Date (which uses local), 
                // Then calculate the difference between Local-String and Target-TZ-String and adjust.

                const tentative = new Date(val.replace(' ', 'T')); // Local interpretation
                const targetString = tentative.toLocaleString('en-US', { timeZone: tz, hour12: false });

                // This doesn't help us find the timestamp. 

                // Let's fallback to: Treat input as Local if TZ is Local, UTC if UTC.
                // For "Asia/Shanghai" specifically, if user is IN Shanghai, it works.
                // If user is elsewhere, it might be off.

                // Given constraints and typical dev tool usage, we can assume standard Date parsing for now unless we add a library or heavy polyfill.
                // Let's warn if timezone !== local.

                // Actually, let's just use the current browser behavior which is usually Local.
                // If the user selects a different timezone, we can't easily respect it for INPUT without a library.
                // *Self-Correction*: The screenshot shows a timezone selector for input.
                // I will ignore the timezone selector for input parsing for now or just treat as local, 
                // OR add a simplified offset if easy (e.g. +8 for Shanghai).

                // Let's try a simple manual offset for Shanghai (UTC+8) since it's the main use case.
                if (tz === 'Asia/Shanghai') {
                    // Create UTC date from components
                    const utc = Date.UTC(y, m - 1, d, h, min, s);
                    // Subtract 8 hours to get the timestamp (since input was +8)
                    const ts = utc - (8 * 60 * 60 * 1000);
                    outputResult(ts);
                    return;
                }
                if (tz === 'UTC') {
                    const ts = Date.UTC(y, m - 1, d, h, min, s);
                    outputResult(ts);
                    return;
                }
            }

            // Fallback for non-regex match or other TZs
            outputResult(date.getTime());
        }

        function outputResult(ms) {
            const unit = elDateUnit.value;
            if (unit === 's') {
                elTsOutput.value = Math.floor(ms / 1000);
            } else {
                elTsOutput.value = ms;
            }
        }

        // --- Helpers ---
        function formatDate(date, timezone) {
            // "2025-12-30 00:33:58" format
            return date.toLocaleString('zh-CN', {
                timeZone: timezone,
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            }).replace(/\//g, '-');
            // Note: zh-CN in Chrome produces yyyy/mm/dd. Replace / with -
        }

        function copyText(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast("Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø");
            }).catch(err => {
                console.error(err);
                showToast("Â§çÂà∂Â§±Ë¥•");
            });
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        // Run
        init();

    </script>
</body>

</html>